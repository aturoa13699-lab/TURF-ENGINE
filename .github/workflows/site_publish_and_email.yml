name: Publish site & email URL

# Manual-only workflow for ad-hoc site publish/testing
# Daily deploys are handled by site_daily.yml
on:
  workflow_dispatch:
    inputs:
      run_date:
        description: "YYYY-MM-DD (blank = today Australia/Sydney)"
        required: false
        default: ""
      send_email:
        description: "Send email (only works if SMTP secrets are configured)"
        required: false
        type: boolean
        default: false

permissions:
  contents: read
  pages: write
  id-token: write

jobs:
  publish:
    uses: ./.github/workflows/site_build_and_deploy.yml
    with:
      mode: demo-run
      run_date: ${{ inputs.run_date || '' }}
      stake_cards_path: out/stake_cards
      send_email: ${{ inputs.send_email || false }}
      upload_publish_json: true
    secrets: inherit
